{% extends "base_public.html" %}
{% load static %}

{% block title %}Verificar código · SGIDT{% endblock %}
{% block css %}
<link rel="stylesheet" href="{% static 'usuarios/css/login.css' %}">
<link rel="stylesheet" href="{% static 'usuarios/css/auth.css' %}">
{% endblock %}

{% block content %}
<section class="auth-wrap">
    <div class="auth-card">
        <h1 class="auth-title">Verifica tu código</h1>
        <p class="auth-subtitle">
            Revisa tu correo e ingresa el código de <strong>6 dígitos</strong>. El código expira en 10 minutos.
        </p>

        <form method="post" novalidate>
            {% csrf_token %}
            {{ form.email }} {# hidden #}

            <div class="form-row">
                <label class="form-label">Código</label>
                <input type="text" name="code" maxlength="6" inputmode="numeric" autocomplete="one-time-code"
                    placeholder="0 0 0 0 0 0" class="form-input code-input" required
                    aria-invalid="{{ form.code.errors|yesno:'true,false' }}"
                    value="{{ form.code.value|default_if_none:'' }}">
                {% if form.code.errors %}
                <div class="field-error">{{ form.code.errors|join:"<br>"|safe }}</div>
                {% endif %}
                <p class="help-text">
                    ¿No te llegó? Revisa “Spam” o
                    <a href="{% url 'usuarios:password_reset_request' %}">solicita otro</a>.
                </p>
            </div>

            <button class="btn-primary" type="submit">Continuar</button>
        </form>

        <div class="link-row">
            <a href="{% url 'usuarios:password_reset_request' %}">Volver a solicitar código</a>
        </div>
    </div>
</section>
{% endblock %}

{% block js %}
<script>
    // Restringe a 6 dígitos
    const code = document.querySelector('input[name="code"]');
    if (code) {
        code.addEventListener('input', () => {
            code.value = code.value.replace(/\D/g, '').slice(0, 6);
        });
    }
</script>
{% endblock %}